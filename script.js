// ========= بيانات الفئات والأسئلة =========
// لكل فئة 6 أسئلة: صف 100 (يمين/يسار) ، صف 300 ، صف 500

const CATEGORIES = [
  // ========== 1) ثقافة عامة ==========
  {
    id: "general",
    name: "ثقافة عامة",
    tag: "أسئلة منوعة",
    image: "images/general.png",
    questions: [
      // 100
      {
        points: 100,
        q: "كم عدد قارات العالم؟",
        options: ["خمس", "ست", "سبع", "ثمان"],
        correct: 2,
      },
      {
        points: 100,
        q: "ما هي عاصمة فرنسا؟",
        options: ["مدريد", "روما", "باريس", "برلين"],
        correct: 2,
      },
      // 300
      {
        points: 300,
        q: "ما هو أطول نهر في العالم؟",
        options: ["الأمازون", "النيـل", "الفرات", "الدانوب"],
        correct: 1,
      },
      {
        points: 300,
        q: "ما هي العملة الرسمية في بريطانيا؟",
        options: ["اليورو", "الدولار", "الجنيه الإسترليني", "الفرنك"],
        correct: 2,
      },
      // 500
      {
        points: 500,
        q: "أيّ من هذه الدول لا تطل على البحر؟",
        options: ["السعودية", "الأردن", "العراق", "المغرب"],
        correct: 2,
      },
      {
        points: 500,
        q: "أيّ من هذه المدن تقع في قارة آسيا؟",
        options: ["ساو باولو", "نيروبي", "طوكيو", "تورنتو"],
        correct: 2,
      },
    ],
  },

  // ========== 2) إسلاميات ==========
  {
    id: "islamic",
    name: "إسلاميات",
    tag: "قرآن وسيرة وفقه",
    image: "images/islamic.png",
    questions: [
      // 100
      {
        points: 100,
        q: "كم عدد أركان الإسلام؟",
        options: ["ثلاثة", "أربعة", "خمسة", "ستة"],
        correct: 2,
      },
      {
        points: 100,
        q: "ما هي أول سورة في المصحف؟",
        options: ["البقرة", "الفاتحة", "الإخلاص", "الناس"],
        correct: 1,
      },
      // 300
      {
        points: 300,
        q: "في أي شهر فُرض صيام رمضان؟",
        options: ["رجب", "شعبان", "رمضان", "ذو الحجة"],
        correct: 2,
      },
      {
        points: 300,
        q: "من هو أول الخلفاء الراشدين؟",
        options: ["عثمان بن عفان", "عمر بن الخطاب", "علي بن أبي طالب", "أبو بكر الصديق"],
        correct: 3,
      },
      // 500
      {
        points: 500,
        q: "كم عدد السور المكية تقريبًا (تقريب تقريبي وليس دقيق)؟",
        options: ["حوالي 30", "حوالي 50", "حوالي 80", "حوالي 100"],
        correct: 1,
      },
      {
        points: 500,
        q: "ما اسم الهجرة الأولى للمسلمين قبل الهجرة إلى المدينة؟",
        options: ["إلى الشام", "إلى الطائف", "إلى الحبشة", "إلى مصر"],
        correct: 2,
      },
    ],
  },

  // ========== 3) علوم ==========
  {
    id: "science",
    name: "علوم",
    tag: "كيمياء وفيزياء وأحياء",
    image: "images/science.png",
    questions: [
      // 100
      {
        points: 100,
        q: "ما هو الكوكب الأحمر؟",
        options: ["الزهرة", "المريخ", "عطارد", "المشتري"],
        correct: 1,
      },
      {
        points: 100,
        q: "ما هي حالة الماء عند درجة حرارة 0 م°؟",
        options: ["سائلة", "صلبة", "غازية", "بلازمية"],
        correct: 1,
      },
      // 300
      {
        points: 300,
        q: "أي عضو يضخ الدم في جسم الإنسان؟",
        options: ["الكبد", "القلب", "الرئة", "الكلى"],
        correct: 1,
      },
      {
        points: 300,
        q: "ما هي وحدة قياس شدة التيار الكهربائي؟",
        options: ["الفولت", "الأمبير", "الأوم", "الواط"],
        correct: 1,
      },
      // 500
      {
        points: 500,
        q: "ما هو العنصر الكيميائي الذي يرمز له بـ Fe؟",
        options: ["النحاس", "الحديد", "الفضة", "الذهب"],
        correct: 1,
      },
      {
        points: 500,
        q: "أيّ من هذه الغازات يشكل النسبة الأكبر في الهواء الجوي؟",
        options: ["الأكسجين", "النيتروجين", "ثاني أكسيد الكربون", "الهيليوم"],
        correct: 1,
      },
    ],
  },

  // ========== 4) تاريخ (عام) ==========
  {
    id: "history",
    name: "تاريخ",
    tag: "أحداث وشخصيات",
    image: "images/history.png",
    questions: [
      // 100
      {
        points: 100,
        q: "في أي قارة تقع مصر؟",
        options: ["آسيا", "أوروبا", "أفريقيا", "أمريكا الجنوبية"],
        correct: 2,
      },
      {
        points: 100,
        q: "في أي قارة تقع المملكة العربية السعودية؟",
        options: ["أوروبا", "آسيا", "أفريقيا", "أمريكا الشمالية"],
        correct: 1,
      },
      // 300
      {
        points: 300,
        q: "في أي عام تقريبًا انتهت الحرب العالمية الثانية؟",
        options: ["1918", "1930", "1945", "1960"],
        correct: 2,
      },
      {
        points: 300,
        q: "من القائد المسلم في معركة حطين؟",
        options: ["خالد بن الوليد", "صلاح الدين الأيوبي", "سعد بن أبي وقاص", "طارق بن زياد"],
        correct: 1,
      },
      // 500
      {
        points: 500,
        q: "أيّ من هذه المدن كانت عاصمة الدولة العباسية لفترة طويلة؟",
        options: ["دمشق", "بغداد", "القاهرة", "قرطبة"],
        correct: 1,
      },
      {
        points: 500,
        q: "أيّ من هذه الدول لم تكن مستعمَرة من بريطانيا؟",
        options: ["الهند", "مصر", "الجزائر", "الأردن"],
        correct: 2,
      },
    ],
  },

  // ========== 5) رياضة عامة ==========
  {
    id: "sports",
    name: "رياضة",
    tag: "مختلف الألعاب",
    image: "images/sports.png",
    questions: [
      // 100
      {
        points: 100,
        q: "كم عدد اللاعبين في فريق كرة القدم داخل الملعب؟",
        options: ["9", "10", "11", "12"],
        correct: 2,
      },
      {
        points: 100,
        q: "ما هي الرياضة التي تُلعب بالكرة والسلة؟",
        options: ["كرة اليد", "كرة السلة", "التنس", "البيسبول"],
        correct: 1,
      },
      // 300
      {
        points: 300,
        q: "كم مدة الشوط الواحد في كرة القدم (بدون الوقت بدل الضائع)؟",
        options: ["30 دقيقة", "35 دقيقة", "45 دقيقة", "60 دقيقة"],
        correct: 2,
      },
      {
        points: 300,
        q: "أي من هذه الرياضات تُلعب على الجليد؟",
        options: ["الهوكي", "كرة اليد", "السباحة", "كرة الطاولة"],
        correct: 0,
      },
      // 500
      {
        points: 500,
        q: "أي من هذه الدول استضافت كأس العالم لكرة القدم من قبل؟",
        options: ["قطر", "المغرب", "النرويج", "اليونان"],
        correct: 0,
      },
      {
        points: 500,
        q: "أي رياضة يُستخدم فيها المضرب وكرة صغيرة على طاولة؟",
        options: ["التنس الأرضي", "الإسكواش", "كرة الطاولة", "البيسبول"],
        correct: 2,
      },
    ],
  },

  // ========== 6) ألغاز ==========
  {
    id: "puzzle",
    name: "ألغاز",
    tag: "تفكير وحدس",
    image: "images/puzzle.png",
    questions: [
      // 100
      {
        points: 100,
        q: "شيء له أسنان ولا يعض، ما هو؟",
        options: ["المشط", "السكين", "القطة", "الأسد"],
        correct: 0,
      },
      {
        points: 100,
        q: "ما هو الشيء الذي يمشي بلا قدمين؟",
        options: ["الماء", "الصوت", "الوقت", "الهواء"],
        correct: 2,
      },
      // 300
      {
        points: 300,
        q: "ما هو الشيء الذي كلما أخذت منه كبر؟",
        options: ["الحفرة", "العمر", "المال", "المعرفة"],
        correct: 0,
      },
      {
        points: 300,
        q: "ما هو الشيء الذي لا يُؤكل في الليل أبدًا؟",
        options: ["الفطور", "الغداء", "العشاء", "الحلوى"],
        correct: 0,
      },
      // 500
      {
        points: 500,
        q: "بيت ليس له أبواب ولا نوافذ، ما هو؟",
        options: ["بيت العنكبوت", "بيت النحل", "بيت الشعر", "بيت الأشباح"],
        correct: 2,
      },
      {
        points: 500,
        q: "شيء تملكه أنت ولكن يستخدمه الناس أكثر منك، ما هو؟",
        options: ["الهاتف", "الاسم", "السيارة", "المنزل"],
        correct: 1,
      },
    ],
  },

  // ========== 7) ماهي الدولة ==========
  {
    id: "which_country",
    name: "ماهي الدولة",
    tag: "خمن الدولة من الوصف",
    image: "images/which_country.png",
    questions: [
      // 100
      {
        points: 100,
        q: "دولة عاصمتها الرياض وتطل على الخليج العربي والبحر الأحمر.",
        options: ["الإمارات", "الكويت", "السعودية", "قطر"],
        correct: 2,
      },
      {
        points: 100,
        q: "دولة عاصمتها القاهرة، يمر فيها نهر النيل.",
        options: ["السودان", "مصر", "ليبيا", "الجزائر"],
        correct: 1,
      },
      // 300
      {
        points: 300,
        q: "دولة آسيوية عاصمتها طوكيو، مشهورة بالأنمي والتقنية.",
        options: ["الصين", "اليابان", "كوريا الجنوبية", "تايلاند"],
        correct: 1,
      },
      {
        points: 300,
        q: "دولة أوروبية عاصمتها برلين، لغتها الألمانية.",
        options: ["النمسا", "ألمانيا", "سويسرا", "هولندا"],
        correct: 1,
      },
      // 500
      {
        points: 500,
        q: "دولة جزرية في المحيط الهادئ، لغتها الرسمية الإنجليزية والماورية، عاصمتها ويلينغتون.",
        options: ["أستراليا", "نيوزيلندا", "الفلبين", "إندونيسيا"],
        correct: 1,
      },
      {
        points: 500,
        q: "دولة في أمريكا الجنوبية، لغتها الرسمية البرتغالية وعاصمتها برازيليا.",
        options: ["الأرجنتين", "البرازيل", "تشيلي", "الأوروغواي"],
        correct: 1,
      },
    ],
  },

  // ========== 8) كوبا أمريكا ==========
  {
    id: "copa_america",
    name: "كوبا أمريكا",
    tag: "بطولة منتخبات أمريكا الجنوبية",
    image: "images/copa_america.png",
    questions: [
      // 100
      {
        points: 100,
        q: "كوبا أمريكا بطولة لمنتخبات أي قارة أساسًا؟",
        options: ["أوروبا", "آسيا", "أمريكا الجنوبية", "أفريقيا"],
        correct: 2,
      },
      {
        points: 100,
        q: "أي منتخب من هذه المنتخبات من أمريكا الجنوبية؟",
        options: ["إسبانيا", "الأرجنتين", "المكسيك", "البرتغال"],
        correct: 1,
      },
      // 300
      {
        points: 300,
        q: "أي منتخب يُلقّب بـ (السامبا)؟",
        options: ["الأوروغواي", "البرازيل", "تشيلي", "بيرو"],
        correct: 1,
      },
      {
        points: 300,
        q: "منتخب يرتدي عادة اللونين الأزرق والأبيض المخطط في كوبا أمريكا.",
        options: ["البرازيل", "الأرجنتين", "كولومبيا", "بوليفيا"],
        correct: 1,
      },
      // 500
      {
        points: 500,
        q: "أي من هذه المنتخبات ليس من أمريكا الجنوبية ولكن شارك ضيفًا أحيانًا في كوبا أمريكا؟",
        options: ["المكسيك", "إسبانيا", "ألمانيا", "نيجيريا"],
        correct: 0,
      },
      {
        points: 500,
        q: "أي من هذه الدول لا تشارك في كوبا أمريكا؟",
        options: ["تشيلي", "باراغواي", "اليابان", "نيجيريا"],
        correct: 3,
      },
    ],
  },

  // ========== 9) أمم أوروبا ==========
  {
    id: "euro_cup",
    name: "أمم أوروبا",
    tag: "بطولة المنتخبات الأوروبية",
    image: "images/euro_cup.png",
    questions: [
      // 100
      {
        points: 100,
        q: "أمم أوروبا بطولة لمنتخبات أي قارة؟",
        options: ["آسيا", "أوروبا", "أفريقيا", "أمريكا الجنوبية"],
        correct: 1,
      },
      {
        points: 100,
        q: "أي من هذه المنتخبات أوروبي؟",
        options: ["البرازيل", "الأرجنتين", "فرنسا", "المكسيك"],
        correct: 2,
      },
      // 300
      {
        points: 300,
        q: "أي منتخب يُلقب بـ (الطواحين)؟",
        options: ["إسبانيا", "هولندا", "ألمانيا", "إيطاليا"],
        correct: 1,
      },
      {
        points: 300,
        q: "منتخب يرتدي غالبًا اللون الأزرق، ويمثّل دولة مشهورة بالبيتزا والمعكرونة.",
        options: ["فرنسا", "إيطاليا", "السويد", "بلجيكا"],
        correct: 1,
      },
      // 500
      {
        points: 500,
        q: "أي منتخب من هذه المنتخبات يُعد من أوروبا الشرقية؟",
        options: ["البرتغال", "بولندا", "أيرلندا", "النرويج"],
        correct: 1,
      },
      {
        points: 500,
        q: "أي منتخب أوروبي معروف بلقب (الماكينات)؟",
        options: ["ألمانيا", "إسبانيا", "إنجلترا", "تركيا"],
        correct: 0,
      },
    ],
  },

  // ========== 10) PL 25/26 (بريميرليغ) ==========
  {
    id: "premier_2526",
    name: "PL 25/26",
    tag: "أسئلة عن الدوري الإنجليزي",
    image: "images/premier_2526.png",
    questions: [
      // 100
      {
        points: 100,
        q: "ما هو اسم الدوري الإنجليزي الأعلى درجة؟",
        options: ["La Liga", "Serie A", "Premier League", "Bundesliga"],
        correct: 2,
      },
      {
        points: 100,
        q: "أي من هذه الأندية إنجليزي؟",
        options: ["ريال مدريد", "برشلونة", "ليفربول", "بايرن ميونخ"],
        correct: 2,
      },
      // 300
      {
        points: 300,
        q: "ما هو لون قميص نادي مانشستر يونايتد الأساسي غالبًا؟",
        options: ["أزرق", "أحمر", "أصفر", "أخضر"],
        correct: 1,
      },
      {
        points: 300,
        q: "في أي مدينة يلعب نادي تشيلسي مبارياته على أرضه؟",
        options: ["مانشستر", "ليفربول", "لندن", "نيوكاسل"],
        correct: 2,
      },
      // 500
      {
        points: 500,
        q: "أي من هذه الأندية ليس من الدوري الإنجليزي؟",
        options: ["آرسنال", "توتنهام", "إيفرتون", "يوفنتوس"],
        correct: 3,
      },
      {
        points: 500,
        q: "أي من هذه الملاعب يوجد في إنجلترا؟",
        options: ["كامب نو", "أليانز أرينا", "أنفيلد", "سان سيرو"],
        correct: 2,
      },
    ],
  },

  // ========== 11) السعودية ==========
  {
    id: "saudi_arabia",
    name: "السعودية",
    tag: "معلومات عن المملكة",
    image: "images/saudi_arabia.png",
    questions: [
      // 100
      {
        points: 100,
        q: "ما هي عاصمة المملكة العربية السعودية؟",
        options: ["جدة", "الرياض", "مكة", "الدمام"],
        correct: 1,
      },
      {
        points: 100,
        q: "أي من هذه المدن تقع على البحر الأحمر؟",
        options: ["جدة", "الرياض", "حائل", "بريدة"],
        correct: 0,
      },
      // 300
      {
        points: 300,
        q: "أي منطقة تشتهر بالعلا والجبال الصخرية الجميلة؟",
        options: ["الشرقية", "الشمالية", "الغربية", "المدينة المنورة"],
        correct: 3,
      },
      {
        points: 300,
        q: "ما هي العملة الرسمية في السعودية؟",
        options: ["الدينار", "الريال السعودي", "الدولار", "اليورو"],
        correct: 1,
      },
      // 500
      {
        points: 500,
        q: "أي من هذه المدن تُعتبر من مدن الجنوب في السعودية؟",
        options: ["أبها", "عرعر", "سكاكا", "تبوك"],
        correct: 0,
      },
      {
        points: 500,
        q: "أيّ من هذه المناطق تُعرف بأنها منطقة صحراوية واسعة؟",
        options: ["الربع الخالي", "تهامة", "الساحل الشرقي", "مرتفعات عسير"],
        correct: 0,
      },
    ],
  },

  // ========== 12) الغربية ==========
  {
    id: "western_region",
    name: "الغربية",
    tag: "مدن ومناطق في غرب السعودية",
    image: "images/western_region.png",
    questions: [
      // 100
      {
        points: 100,
        q: "أي من هذه المدن تقع في المنطقة الغربية؟",
        options: ["جدة", "الدمام", "حائل", "سكاكا"],
        correct: 0,
      },
      {
        points: 100,
        q: "أي مدينة تضم المسجد الحرام؟",
        options: ["مكة المكرمة", "المدينة المنورة", "جدة", "الطائف"],
        correct: 0,
      },
      // 300
      {
        points: 300,
        q: "مدينة سعودية في الغربية مشهورة بالورود والطقس المعتدل صيفًا.",
        options: ["الرياض", "الطائف", "تبوك", "جازان"],
        correct: 1,
      },
      {
        points: 300,
        q: "أي من هذه المدن تقع في منطقة المدينة المنورة؟",
        options: ["ينبع", "الخبر", "الجبيل", "خميس مشيط"],
        correct: 0,
      },
      // 500
      {
        points: 500,
        q: "ميناء سعودي مهم على ساحل البحر الأحمر في المنطقة الغربية.",
        options: ["ميناء جدة الإسلامي", "ميناء الجبيل", "ميناء الملك عبدالعزيز", "ميناء ضباء"],
        correct: 0,
      },
      {
        points: 500,
        q: "مدينة في الغربية تُعتبر وجهة سياحية جبلية وتقع قرب مكة.",
        options: ["الطائف", "حائل", "نجران", "عرعر"],
        correct: 0,
      },
    ],
  },

  // ========== 13) شعارات سعودية ==========
  {
    id: "saudi_logos",
    name: "شعارات سعودية",
    tag: "شعارات أندية وشركات سعودية",
    image: "images/saudi_logos.png",
    questions: [
      // 100
      {
        points: 100,
        q: "شعار يحتوي على نخلة وسيفين متقاطعين يرمز إلى:",
        options: ["شعار دولة السعودية", "نادي الهلال", "أرامكو", "الاتحاد"],
        correct: 0,
      },
      {
        points: 100,
        q: "شعار نادي الهلال يحتوي غالبًا على:",
        options: ["كرة وسفينة", "هلال وكرة", "نخلة", "نمر"],
        correct: 1,
      },
      // 300
      {
        points: 300,
        q: "شعار نادي الاتحاد يتضمن:",
        options: ["نسر", "نمر", "صقر", "أسد"],
        correct: 1,
      },
      {
        points: 300,
        q: "شعار شركة أرامكو السعودية يغلب عليه لون:",
        options: ["الأحمر", "الأصفر", "الأخضر والأزرق", "البرتقالي"],
        correct: 2,
      },
      // 500
      {
        points: 500,
        q: "شعار نادي النصر السعودي يحتوي عادةً على:",
        options: ["شكل خريطة وشريط", "سفينة", "برج", "نخلة"],
        correct: 0,
      },
      {
        points: 500,
        q: "شعار نادي الأهلي السعودي كان يتضمن:",
        options: ["نخلة فقط", "صقر فقط", "درع مع نخلة وكرة", "نمر"],
        correct: 2,
      },
    ],
  },

  // ========== 14) مطاعم سعودية ==========
  {
    id: "saudi_restaurants",
    name: "مطاعم سعودية",
    tag: "مطاعم مشهورة داخل السعودية",
    image: "images/saudi_restaurants.png",
    questions: [
      // 100
      {
        points: 100,
        q: "أي من هذه المطاعم معروف بتقديم الشاورما؟",
        options: ["ماكدونالدز", "هرفي", "شاورمر", "بيتزا هت"],
        correct: 2,
      },
      {
        points: 100,
        q: "أي من هذه العلامات متخصصة في البيتزا؟",
        options: ["البيك", "دومينوز", "كودو", "الطازج"],
        correct: 1,
      },
      // 300
      {
        points: 300,
        q: "مطعم سعودي شهير مرتبط بالدجاج المقلي وله فروع كثيرة.",
        options: ["البيك", "شاورمر", "هرفي", "برغر كنج"],
        correct: 0,
      },
      {
        points: 300,
        q: "أي من هذه المطاعم سعودي المنشأ؟",
        options: ["البيك", "ماكدونالدز", "دومينوز", "بيتزا هت"],
        correct: 0,
      },
      // 500
      {
        points: 500,
        q: "أي من هذه المطاعم يُقدّم عادة وجبات شعبية سعودية أكثر من الوجبات السريعة؟",
        options: ["مطاعم المندي", "برغر كنج", "دومينوز", "بيتزا هت"],
        correct: 0,
      },
      {
        points: 500,
        q: "أي من هذه الخيارات أقرب لوصف مطعم (الطازج)؟",
        options: ["متخصص بالسمك", "متخصص بالدجاج والشوي", "متخصص بالبيتزا", "متخصص بالبرغر فقط"],
        correct: 1,
      },
    ],
  },

  // ========== 15) شعارات عالمية ==========
  {
    id: "global_logos",
    name: "شعارات عالمية",
    tag: "شركات وعلامات دولية",
    image: "images/global_logos.png",
    questions: [
      // 100
      {
        points: 100,
        q: "شعار على شكل تفاحة مقضومة يرمز لشركة:",
        options: ["سامسونج", "مايكروسوفت", "آبل", "سوني"],
        correct: 2,
      },
      {
        points: 100,
        q: "شعار حرف M أصفر على خلفية حمراء يرمز إلى:",
        options: ["ماكدونالدز", "بيبسي", "كوكاكولا", "كنتاكي"],
        correct: 0,
      },
      // 300
      {
        points: 300,
        q: "شعار يحتوي على 4 حلقات مترابطة يرمز إلى:",
        options: ["بي إم دبليو", "أودي", "مرسيدس", "فولكس فاغن"],
        correct: 1,
      },
      {
        points: 300,
        q: "شعار طائر على أجهزة إلكترونية محمولة معروف باسم:",
        options: ["Dell", "Asus", "Acer", "Twitter (X سابقًا)"],
        correct: 3,
      },
      // 500
      {
        points: 500,
        q: "شعار شركة (Nike) عبارة عن:",
        options: ["كرة", "خط منحني (سوش)", "تفاحة", "درع"],
        correct: 1,
      },
      {
        points: 500,
        q: "شعار شركة (Mercedes-Benz) عبارة عن:",
        options: ["حصان", "نسر", "نجمة ثلاثية داخل دائرة", "أسد"],
        correct: 2,
      },
    ],
  },

  // ========== 16) سيارات ==========
  {
    id: "cars",
    name: "سيارات",
    tag: "ماركات ومعلومات سيارات",
    image: "images/cars.png",
    questions: [
      // 100
      {
        points: 100,
        q: "أي من هذه ماركة سيارات ألمانية؟",
        options: ["تويوتا", "مرسيدس", "هيونداي", "كيا"],
        correct: 1,
      },
      {
        points: 100,
        q: "أي من هذه ماركة سيارات يابانية؟",
        options: ["بي إم دبليو", "تويوتا", "فورد", "رونو"],
        correct: 1,
      },
      // 300
      {
        points: 300,
        q: "أي من هذه السيارات تُعتبر (سيدان) تقليديًا؟",
        options: ["تويوتا كامري", "تويوتا هايلكس", "فورد إكسبلورر", "جيب رانجلر"],
        correct: 0,
      },
      {
        points: 300,
        q: "أي من هذه الماركات متخصصة أكثر في السيارات الفاخرة؟",
        options: ["تويوتا", "بي إم دبليو", "دايهاتسو", "سوزوكي"],
        correct: 1,
      },
      // 500
      {
        points: 500,
        q: "أي من هذه الشركات معروفة كشركة أمريكية لصناعة السيارات؟",
        options: ["فورد", "فولكس فاغن", "بيجو", "ميتسوبيشي"],
        correct: 0,
      },
      {
        points: 500,
        q: "أي من هذه السيارات تُصنّف عادةً كـ SUV؟",
        options: ["هوندا سيفيك", "مرسيدس S-Class", "تويوتا لاند كروزر", "تويوتا كورولا"],
        correct: 2,
      },
    ],
  },

  // ========== 17) السيرة النبوية ==========
  {
    id: "prophet_seerah",
    name: "السيرة النبوية",
    tag: "أحداث من حياة النبي ﷺ",
    image: "images/prophet_seerah.png",
    questions: [
      // 100
      {
        points: 100,
        q: "في أي مدينة وُلد النبي محمد ﷺ؟",
        options: ["المدينة المنورة", "مكة المكرمة", "الطائف", "اليمن"],
        correct: 1,
      },
      {
        points: 100,
        q: "ما اسم والد النبي ﷺ؟",
        options: ["عبد الله", "عبد المطلب", "أبو طالب", "حمزة"],
        correct: 0,
      },
      // 300
      {
        points: 300,
        q: "ما اسم أول زوجة للنبي ﷺ؟",
        options: ["عائشة رضي الله عنها", "حفصة رضي الله عنها", "خديجة رضي الله عنها", "أم سلمة رضي الله عنها"],
        correct: 2,
      },
      {
        points: 300,
        q: "في أي مدينة دُفن النبي ﷺ؟",
        options: ["مكة المكرمة", "المدينة المنورة", "القدس", "الطائف"],
        correct: 1,
      },
      // 500
      {
        points: 500,
        q: "ما اسم الغار الذي كان فيه النبي ﷺ عندما نزل عليه الوحي أول مرة؟",
        options: ["غار حراء", "غار ثور", "غار أحد", "غار بدر"],
        correct: 0,
      },
      {
        points: 500,
        q: "من هو الصحابي الذي نام في فراش النبي ﷺ ليلة الهجرة؟",
        options: ["أبو بكر الصديق", "عمر بن الخطاب", "علي بن أبي طالب", "عثمان بن عفان"],
        correct: 2,
      },
    ],
  },

  // ========== 18) أعلام ==========
  {
    id: "flags",
    name: "أعلام",
    tag: "أعلام دول مختلفة",
    image: "images/flags.png",
    questions: [
      // 100
      {
        points: 100,
        q: "أي علم يحتوي على لون أخضر وكتابة (لا إله إلا الله)؟",
        options: ["علم السعودية", "علم مصر", "علم فرنسا", "علم قطر"],
        correct: 0,
      },
      {
        points: 100,
        q: "أي علم يحتوي على ألوان: أحمر وأبيض وأزرق بخطوط أفقية؟",
        options: ["هولندا", "ألمانيا", "إيطاليا", "إسبانيا"],
        correct: 0,
      },
      // 300
      {
        points: 300,
        q: "أي علم فيه ورقة قيقب (شجرة) في المنتصف؟",
        options: ["أستراليا", "البرازيل", "كندا", "الهند"],
        correct: 2,
      },
      {
        points: 300,
        q: "أي علم من هذه الأعلام لدولة عربية في شمال أفريقيا؟",
        options: ["علم الأرجنتين", "علم تونس", "علم اليابان", "علم السويد"],
        correct: 1,
      },
      // 500
      {
        points: 500,
        q: "أي علم من هذه الأعلام لدولة آسيوية إسلامية ذات لون أخضر ونجم وهلال أبيض؟",
        options: ["تركيا", "ماليزيا", "باكستان", "بنغلادش"],
        correct: 2,
      },
      {
        points: 500,
        q: "أي علم من هذه الأعلام لدولة فيها صليب أبيض على خلفية حمراء؟",
        options: ["سويسرا", "النرويج", "الدانمارك", "فنلندا"],
        correct: 0,
      },
    ],
  },

  // ========== 19) عملات ==========
  {
    id: "currencies",
    name: "عملات",
    tag: "عملات دول مختلفة",
    image: "images/currencies.png",
    questions: [
      // 100
      {
        points: 100,
        q: "ما هي عملة المملكة العربية السعودية؟",
        options: ["الدينار", "الريال السعودي", "الدولار", "اليورو"],
        correct: 1,
      },
      {
        points: 100,
        q: "ما هي العملة الرسمية للولايات المتحدة الأمريكية؟",
        options: ["اليورو", "الدولار الأمريكي", "الجنيه", "الفرنك"],
        correct: 1,
      },
      // 300
      {
        points: 300,
        q: "أي من هذه العملات تُستخدم في بريطانيا؟",
        options: ["اليورو", "الجنيه الإسترليني", "الريال", "الدينار"],
        correct: 1,
      },
      {
        points: 300,
        q: "ما هي عملة دولة اليابان؟",
        options: ["الين", "اليوان", "الريال", "الدينار"],
        correct: 0,
      },
      // 500
      {
        points: 500,
        q: "أي من هذه العملات تستخدمها دولة عربية؟",
        options: ["الفرنك", "البيزو", "الدرهم", "الكرونة"],
        correct: 2,
      },
      {
        points: 500,
        q: "أي من هذه العملات تُستخدم في دول أوروبية عديدة؟",
        options: ["اليورو", "الريال", "الدولار", "الجنيه المصري"],
        correct: 0,
      },
    ],
  },

  // ========== 20) حروف ==========
  {
    id: "letters",
    name: "حروف",
    tag: "كلمات تبدأ بحروف معيّنة",
    image: "images/letters.png",
    questions: [
      // 100
      {
        points: 100,
        q: "اختر الكلمة التي تبدأ بحرف (م):",
        options: ["بيت", "شجرة", "مطر", "قلم"],
        correct: 2,
      },
      {
        points: 100,
        q: "أي كلمة من هذه تبدأ بحرف (س)؟",
        options: ["باب", "سفينة", "طاولة", "قمر"],
        correct: 1,
      },
      // 300
      {
        points: 300,
        q: "أي كلمة من هذه تنتهي بحرف (ر)؟",
        options: ["قمر", "كتاب", "شجرة", "مكتب"],
        correct: 0,
      },
      {
        points: 300,
        q: "أي كلمة من هذه تحتوي على حرف (خ)؟",
        options: ["مطر", "خبز", "شمس", "باب"],
        correct: 1,
      },
      // 500
      {
        points: 500,
        q: "أي كلمة من هذه تحتوي على حرفين متماثلين متتاليين؟",
        options: ["شجر", "سيارة", "مكة", "حديقة"],
        correct: 2,
      },
      {
        points: 500,
        q: "أي كلمة من هذه تحتوي على حرف (ض)؟",
        options: ["شاطر", "مريض", "رياضة", "سريع"],
        correct: 2,
      },
    ],
  },

  // ========== 21) خمن الصورة ==========
  {
    id: "guess_image",
    name: "خمن الصورة",
    tag: "أسئلة تعتمد على صورة يوضحها المنظّم",
    image: "images/guess_image.png",
    questions: [
      // 100
      {
        points: 100,
        q: "يعرض المنظّم صورة لفاكهة صفراء طويلة. ما هي؟",
        options: ["تفاح", "موز", "برتقال", "عنب"],
        correct: 1,
      },
      {
        points: 100,
        q: "يعرض المنظّم صورة لشيء يُلبس في القدم. ما هو؟",
        options: ["قبعة", "ساعة", "حذاء", "نظارة"],
        correct: 2,
      },
      // 300
      {
        points: 300,
        q: "يعرض المنظّم صورة لصحراء وجمال. ما أقرب وصف للصورة؟",
        options: ["مدينة كبيرة", "شاطئ بحر", "صحراء عربية", "غابة استوائية"],
        correct: 2,
      },
      {
        points: 300,
        q: "يعرض المنظّم صورة لكتاب وقلم ومكتب. ما الفكرة الأقرب؟",
        options: ["مطعم", "مدرسة/دراسة", "ملعب", "مستشفى"],
        correct: 1,
      },
      // 500
      {
        points: 500,
        q: "صورة لبرج مشهور في باريس. ما هو؟",
        options: ["برج خليفة", "برج القاهرة", "برج إيفل", "برج بيزا"],
        correct: 2,
      },
      {
        points: 500,
        q: "صورة لساعة كبيرة على برج في لندن. ما اسمها الشهير؟",
        options: ["بيغ بن", "برج إيفل", "غرينتش", "البيغ تاور"],
        correct: 0,
      },
    ],
  },

  // ========== 22) كأس الخليج ==========
  {
    id: "gulf_cup",
    name: "كأس الخليج",
    tag: "بطولة منتخبات الخليج",
    image: "images/gulf_cup.png",
    questions: [
      // 100
      {
        points: 100,
        q: "أي من هذه المنتخبات خليجي؟",
        options: ["السعودية", "مصر", "المغرب", "تونس"],
        correct: 0,
      },
      {
        points: 100,
        q: "أي من هذه الدول ليست من دول الخليج؟",
        options: ["الكويت", "قطر", "عمان", "الأردن"],
        correct: 3,
      },
      // 300
      {
        points: 300,
        q: "ما هو لون قميص منتخب السعودية غالبًا؟",
        options: ["أصفر", "أخضر وأبيض", "أحمر", "أزرق"],
        correct: 1,
      },
      {
        points: 300,
        q: "أي منتخب خليجي يُلقب بالأزرق؟",
        options: ["السعودية", "الكويت", "قطر", "الإمارات"],
        correct: 1,
      },
      // 500
      {
        points: 500,
        q: "أي من هذه المنتخبات شارك أكثر من مرة في كأس الخليج؟",
        options: ["العراق", "مصر", "الجزائر", "لبنان"],
        correct: 0,
      },
      {
        points: 500,
        q: "أي دولة من هذه تستضيف كأس الخليج أحيانًا كونها خليجية؟",
        options: ["السودان", "عمان", "ليبيا", "سوريا"],
        correct: 1,
      },
    ],
  },

  // ========== 23) الكلاسيكو (برشلونة × ريال مدريد) ==========
  {
    id: "el_clasico",
    name: "الكلاسيكو بين برشلونة وريال مدريد",
    tag: "أشهر مباراة في إسبانيا",
    image: "images/el_clasico.png",
    questions: [
      // 100
      {
        points: 100,
        q: "في أي دولة يُقام الكلاسيكو بين برشلونة وريال مدريد؟",
        options: ["إيطاليا", "إنجلترا", "إسبانيا", "فرنسا"],
        correct: 2,
      },
      {
        points: 100,
        q: "ما هو لون قميص برشلونة الأساسي غالبًا؟",
        options: ["أبيض", "أزرق وأحمر (عنابي)", "أصفر", "أخضر"],
        correct: 1,
      },
      // 300
      {
        points: 300,
        q: "ما هو لون قميص ريال مدريد الأساسي غالبًا؟",
        options: ["أبيض", "أحمر", "أزرق", "أصفر"],
        correct: 0,
      },
      {
        points: 300,
        q: "أي من هذه الملاعب يُعتبر ملعب برشلونة؟",
        options: ["سانتياغو برنابيو", "كامب نو/سبوتيفاي كامب نو", "أليانز أرينا", "ستامفورد بريدج"],
        correct: 1,
      },
      // 500
      {
        points: 500,
        q: "أي من هذه الملاعب يُعتبر ملعب ريال مدريد؟",
        options: ["أولد ترافورد", "سانتياغو برنابيو", "كامب نو", "أليانز"],
        correct: 1,
      },
      {
        points: 500,
        q: "أي من هذه الأندية ليست من إسبانيا؟",
        options: ["فالنسيا", "إشبيلية", "أتليتكو مدريد", "يوفنتوس"],
        correct: 3,
      },
    ],
  },

  // ========== 24) مسيرة اللاعب ==========
  {
    id: "player_career",
    name: "مسيرة اللاعب",
    tag: "من الأندية تتعرف على اللاعب",
    image: "images/player_career.png",
    questions: [
      // 100
      {
        points: 100,
        q: "لعب لسنوات طويلة في برشلونة والمنتخب الأرجنتيني، من هو؟",
        options: ["رونالدو البرازيلي", "ليونيل ميسي", "نيمار", "مبابي"],
        correct: 1,
      },
      {
        points: 100,
        q: "لعب في ريال مدريد مع المنتخب البرتغالي، من هو؟",
        options: ["كريستيانو رونالدو", "رونالدينيو", "بيكهام", "راؤول"],
        correct: 0,
      },
      // 300
      {
        points: 300,
        q: "لاعب سعودي ارتبط اسمه كثيرًا بنادي الهلال والمنتخب السعودي (مهاجم تاريخي).",
        options: ["ياسر القحطاني", "سامي الجابر", "محمد نور", "سعيد العويران"],
        correct: 1,
      },
      {
        points: 300,
        q: "لاعب سعودي اشتهر في الاتحاد والمنتخب السعودي كلاعب وسط هجومي.",
        options: ["محمد الشلهوب", "محمد نور", "سلمان الفرج", "حسين عبدالغني"],
        correct: 1,
      },
      // 500
      {
        points: 500,
        q: "لعب لأندية: سانتوس، برشلونة، باريس سان جيرمان. من هو؟",
        options: ["ميسي", "نيمار", "سواريز", "كوتينيو"],
        correct: 1,
      },
      {
        points: 500,
        q: "لعب لأندية: سبورتنغ لشبونة، مانشستر يونايتد، ريال مدريد، يوفنتوس. من هو؟",
        options: ["كريستيانو رونالدو", "لويس فيغو", "رونالدو البرازيلي", "زيدان"],
        correct: 0,
      },
    ],
  },

  // ========== 25) رقم اللاعب ==========
  {
    id: "player_number",
    name: "رقم اللاعب",
    tag: "تعرف على اللاعب من رقمه",
    image: "images/player_number.png",
    questions: [
      // 100
      {
        points: 100,
        q: "أي لاعب ارتبط بالرقم 7 في مانشستر يونايتد وريال مدريد؟",
        options: ["كريستيانو رونالدو", "ميسي", "نيمار", "راموس"],
        correct: 0,
      },
      {
        points: 100,
        q: "الرقم الأشهر على قميص ميسي لفترة طويلة في برشلونة.",
        options: ["7", "9", "10", "11"],
        correct: 2,
      },
      // 300
      {
        points: 300,
        q: "أي رقم اشتهر به ياسر القحطاني مع الهلال؟",
        options: ["9", "10", "11", "20"],
        correct: 0,
      },
      {
        points: 300,
        q: "أي رقم اشتهر به سيرخيو راموس في ريال مدريد؟",
        options: ["3", "4", "5", "6"],
        correct: 1,
      },
      // 500
      {
        points: 500,
        q: "أي من هذه الأرقام غالبًا ما يرتبط بمركز حارس المرمى؟",
        options: ["1", "7", "9", "11"],
        correct: 0,
      },
      {
        points: 500,
        q: "أي رقم غالبًا ما يرتبط بمهاجم صريح (رأس حربة) تقليديًا؟",
        options: ["2", "3", "5", "9"],
        correct: 3,
      },
    ],
  },

  // ========== 26) من هو اللاعب ==========
  {
    id: "who_is_player",
    name: "من هو اللاعب",
    tag: "تعرف على اللاعب من الوصف",
    image: "images/who_is_player.png",
    questions: [
      // 100
      {
        points: 100,
        q: "لاعب أرجنتيني قصير القامة، لعب لبرشلونة وباريس ومنتخب الأرجنتين.",
        options: ["ميسي", "أغويرو", "دي ماريا", "ديبالا"],
        correct: 0,
      },
      {
        points: 100,
        q: "لاعب برتغالي هداف، لعب لريال مدريد ومانشستر يونايتد.",
        options: ["فيغو", "رونالدو الظاهرة", "كريستيانو رونالدو", "بيبي"],
        correct: 2,
      },
      // 300
      {
        points: 300,
        q: "أسطورة إيطالية في حراسة المرمى، لعب فترة طويلة في يوفنتوس.",
        options: ["بوفون", "دوناروما", "كاسياس", "نوير"],
        correct: 0,
      },
      {
        points: 300,
        q: "لاعب برازيلي مشهور بالمراوغة، لعب لبرشلونة وميلان.",
        options: ["رونالدينيو", "رونالدو", "كاكا", "نيمار"],
        correct: 0,
      },
      // 500
      {
        points: 500,
        q: "لاعب فرنسي، فاز بكأس العالم 1998، واشتهر بضربة رأس في نهائي 2006.",
        options: ["تريزيغيه", "أنري", "زيدان", "ريبيري"],
        correct: 2,
      },
      {
        points: 500,
        q: "لاعب إنجليزي معروف بالكرات الثابتة، لعب لمانشستر يونايتد وريال مدريد.",
        options: ["جيرارد", "لامبارد", "بيكهام", "روني"],
        correct: 2,
      },
    ],
  },

  // ========== 27) الدوري السعودي ==========
  {
    id: "saudi_league",
    name: "الدوري السعودي",
    tag: "أندية ولاعبين من دوري روشن",
    image: "images/saudi_league.png",
    questions: [
      // 100
      {
        points: 100,
        q: "أي من هذه الأندية سعودي؟",
        options: ["برشلونة", "الهلال", "بايرن ميونخ", "آرسنال"],
        correct: 1,
      },
      {
        points: 100,
        q: "أي من هذه الأندية من جدة؟",
        options: ["الهلال", "النصر", "الاتحاد", "التعاون"],
        correct: 2,
      },
      // 300
      {
        points: 300,
        q: "أي نادٍ سعودي يُلقب بـ (العالمي)؟",
        options: ["الهلال", "النصر", "الاتحاد", "الأهلي"],
        correct: 1,
      },
      {
        points: 300,
        q: "أي نادٍ سعودي يُلقب بـ (الزعيم)؟",
        options: ["الهلال", "النصر", "الاتحاد", "الشباب"],
        correct: 0,
      },
      // 500
      {
        points: 500,
        q: "أي من هذه الأندية يلعب في مدينة الدمام؟",
        options: ["الرائد", "الاتفاق", "التعاون", "الفيصلي"],
        correct: 1,
      },
      {
        points: 500,
        q: "أي من هذه الأندية ينتمي لمنطقة القصيم؟",
        options: ["الاتحاد", "النصر", "التعاون", "الاتفاق"],
        correct: 2,
      },
    ],
  },

  // ========== 28) شعارات كروية ==========
  {
    id: "football_logos",
    name: "شعارات كروية",
    tag: "شعارات أندية كرة قدم",
    image: "images/football_logos.png",
    questions: [
      // 100
      {
        points: 100,
        q: "شعار فيه كرة وكلمة (FC Barcelona) يخص نادي:",
        options: ["ريال مدريد", "برشلونة", "أتلتيكو مدريد", "فالنسيا"],
        correct: 1,
      },
      {
        points: 100,
        q: "شعار أبيض يحتوي حرف (RMCF) يرمز لنادي:",
        options: ["برشلونة", "بايرن ميونخ", "ريال مدريد", "يوفنتوس"],
        correct: 2,
      },
      // 300
      {
        points: 300,
        q: "شعار فيه مدفع صغير يرمز لنادي:",
        options: ["مانشستر سيتي", "آرسنال", "توتنهام", "ليفربول"],
        correct: 1,
      },
      {
        points: 300,
        q: "شعار نادي إنجليزي يحمل صورة أسد واقف واسم (Chelsea).",
        options: ["ليفربول", "آرسنال", "تشيلسي", "إيفرتون"],
        correct: 2,
      },
      // 500
      {
        points: 500,
        q: "شعار نسرين يواجهان بعضهما ونجمة يخص نادي تركي كبير.",
        options: ["غلطة سراي", "فنربخشة", "بشكتاش", "طرابزون سبور"],
        correct: 2,
      },
      {
        points: 500,
        q: "شعار فيه حرف (BVB 09) يخص نادي:",
        options: ["بايرن ميونخ", "دورتموند", "لايبزيغ", "شالكه"],
        correct: 1,
      },
    ],
  },

  // ========== 29) خمن الصورة كروية ==========
  {
    id: "guess_football_image",
    name: "خمن الصورة كروية",
    tag: "صور لاعبين وملاعب",
    image: "images/guess_football_image.png",
    questions: [
      // 100
      {
        points: 100,
        q: "يعرض المنظّم صورة لاعب يرتدي قميص أزرق وأحمر ويحمل رقم 10 في برشلونة سابقًا.",
        options: ["نيمار", "ميسي", "سواريز", "تشافي"],
        correct: 1,
      },
      {
        points: 100,
        q: "صورة لاعب بقميص أبيض لريال مدريد، مشهور بالرقم 7.",
        options: ["بنزيما", "راموس", "كريستيانو رونالدو", "مودريتش"],
        correct: 2,
      },
      // 300
      {
        points: 300,
        q: "صورة لملعب كبير في لندن لنادي آرسنال.",
        options: ["ستامفورد بريدج", "أولد ترافورد", "الاتحاد", "الإمارات"],
        correct: 3,
      },
      {
        points: 300,
        q: "صورة لمشجعين يرفعون أعلام صفراء وسوداء في مدرجات نادي ألماني شهير.",
        options: ["بايرن ميونخ", "دورتموند", "لايبزيغ", "شالكه"],
        correct: 1,
      },
      // 500
      {
        points: 500,
        q: "صورة لاعب برازيلي بشعر مجعد، قميص برشلونة رقم 10 في 2006 تقريبًا.",
        options: ["رونالدو", "رونالدينيو", "ريفالدو", "كاكا"],
        correct: 1,
      },
      {
        points: 500,
        q: "صورة لاعب سعودي بقميص الهلال رقم 9 يحتفل بتسجيل هدف.",
        options: ["سامي الجابر", "ياسر القحطاني", "محمد الشلهوب", "سالم الدوسري"],
        correct: 1,
      },
    ],
  },
];


const CATEGORY_MAP = Object.fromEntries(CATEGORIES.map((c) => [c.id, c]));

// ========= عناصر DOM =========

// شاشات
const teamsScreen = document.getElementById("teams-screen");
const categoriesScreen = document.getElementById("categories-screen");
const boardScreen = document.getElementById("board-screen");

// شاشة الفرق
const team1Input = document.getElementById("team1-input");
const team2Input = document.getElementById("team2-input");
const toCategoriesBtn = document.getElementById("to-categories-btn");

// شاشة الفئات
const categoriesGrid = document.getElementById("categories-grid");
const selectedCountEl = document.getElementById("selected-count");
const backToTeamsBtn = document.getElementById("back-to-teams-btn");
const startGameBtn = document.getElementById("start-game-btn");

// لوحة
const boardContainer = document.getElementById("board-container");
const backToCategoriesBtn = document.getElementById("back-to-categories-btn");

const team1NameEl = document.getElementById("team1-name");
const team2NameEl = document.getElementById("team2-name");
const team1ScoreEl = document.getElementById("team1-score");
const team2ScoreEl = document.getElementById("team2-score");
const currentTeamLabelEl = document.getElementById("current-team-label");
const team1BoxEl = document.getElementById("team1-box");
const team2BoxEl = document.getElementById("team2-box");
const modalTimerEl = document.getElementById("modal-timer");

// مودال السؤال
const questionModal = document.getElementById("question-modal");
const modalCategoryLabel = document.getElementById("modal-category-label");
const modalPointsLabel = document.getElementById("modal-points-label");
const questionTextEl = document.getElementById("question-text");
const optionsButtons = Array.from(document.querySelectorAll(".option-btn"));
const statusTextEl = document.getElementById("status-text");
const closeQuestionBtn = document.getElementById("close-question-btn");

// lifelines داخل المودال
const lifelineTeamNameEl = document.getElementById("lifeline-team-name");
const lifelineFiftyCountEl = document.getElementById("lifeline-fifty-count");
const lifelineCallCountEl = document.getElementById("lifeline-call-count");
const lifelineButtons = Array.from(document.querySelectorAll(".lifeline-btn"));

// ========= حالة اللعبة =========
let team1Name = "الفريق 1";
let team2Name = "الفريق 2";
let team1Score = 0;
let team2Score = 0;

let currentTeam = 1; // 1 أو 2
let nextStartingTeam = 1; // من يبدأ السؤال القادم

const FIRST_CHANCE_SECONDS = 60;
const SECOND_CHANCE_SECONDS = 15;
const CALL_FRIEND_SECONDS = 90; // 1:30

let timerIntervalId = null;
let remainingSeconds = FIRST_CHANCE_SECONDS;

// phase = "idle" | "first" | "second"
let phase = "idle";
let questionEnded = false;

let selectedCategoryIds = []; // 6 فئات
let currentCategoryId = null;
let currentQuestionIndex = null;
let currentQuestion = null;
let currentTileButton = null;

// lifelines state لكل فريق
const lifelines = {
  1: { fifty: 1, call: 1 },
  2: { fifty: 1, call: 1 },
};

// ========= دوال مساعدة =========
function formatTime(seconds) {
  const s = seconds % 60;
  const m = Math.floor(seconds / 60);
  const mm = m.toString().padStart(2, "0");
  const ss = s.toString().padStart(2, "0");
  return `${mm}:${ss}`;
}

function setActiveTeamUI() {
  team1BoxEl.classList.toggle("active", currentTeam === 1);
  team2BoxEl.classList.toggle("active", currentTeam === 2);
  currentTeamLabelEl.textContent = currentTeam === 1 ? team1Name : team2Name;
}

function stopTimer() {
  if (timerIntervalId !== null) {
    clearInterval(timerIntervalId);
    timerIntervalId = null;
  }
}

function startTimer(seconds) {
  stopTimer();
  remainingSeconds = seconds;

  // نحدث الهيدر إذا موجود
  if (timerEl) {
    timerEl.textContent = formatTime(remainingSeconds);
  }
  // نحدث تايمر المودال إذا موجود
  if (modalTimerEl) {
    modalTimerEl.textContent = formatTime(remainingSeconds);
  }

  timerIntervalId = setInterval(() => {
    remainingSeconds -= 1;

    if (remainingSeconds <= 0) {
      if (timerEl) timerEl.textContent = "00:00";
      if (modalTimerEl) modalTimerEl.textContent = "00:00";

      stopTimer();
      handleTimeUp();
    } else {
      const t = formatTime(remainingSeconds);
      if (timerEl) timerEl.textContent = t;
      if (modalTimerEl) modalTimerEl.textContent = t;
    }
  }, 1000);
}

function resetOptionsState() {
  optionsButtons.forEach((btn) => {
    btn.classList.remove("correct", "wrong");
    btn.disabled = false;
    btn.style.display = "block";
    btn.style.opacity = 1;
  });
}

function getCurrentTeamName() {
  return currentTeam === 1 ? team1Name : team2Name;
}

function updateLifelinesUI() {
  // نعرض فقط وسائل مساعدة الفريق الحالي
  lifelineTeamNameEl.textContent = getCurrentTeamName();
  lifelineFiftyCountEl.textContent = lifelines[currentTeam].fifty;
  lifelineCallCountEl.textContent = lifelines[currentTeam].call;

  lifelineButtons.forEach((btn) => {
    const type = btn.dataset.type;
    const count = lifelines[currentTeam][type];
    btn.disabled = count <= 0;
  });
}

// ========= انتقال شاشة الفرق → الفئات =========
toCategoriesBtn.addEventListener("click", () => {
  team1Name = (team1Input.value || "الفريق 1").trim() || "الفريق 1";
  team2Name = (team2Input.value || "الفريق 2").trim() || "الفريق 2";

  team1NameEl.textContent = team1Name;
  team2NameEl.textContent = team2Name;

  teamsScreen.classList.add("hidden");
  categoriesScreen.classList.remove("hidden");

  buildCategoriesGrid();
});

// ========= شاشة الفئات =========
function buildCategoriesGrid() {
  categoriesGrid.innerHTML = "";
  selectedCategoryIds = [];
  selectedCountEl.textContent = "0";
  startGameBtn.disabled = true;

  CATEGORIES.forEach((cat) => {
    const card = document.createElement("div");
    card.className = "category-card";
    card.dataset.id = cat.id;

    card.innerHTML = `
      <img src="${cat.image}" alt="${cat.name}" class="category-image" />
      <div class="category-body">
        <div class="category-title">${cat.name}</div>
        <div class="category-tag">${cat.tag}</div>
      </div>
    `;

    card.addEventListener("click", () => toggleCategorySelect(cat.id, card));
    categoriesGrid.appendChild(card);
  });
}

function toggleCategorySelect(id, cardEl) {
  const index = selectedCategoryIds.indexOf(id);
  if (index === -1) {
    if (selectedCategoryIds.length >= 6) return;
    selectedCategoryIds.push(id);
    cardEl.classList.add("selected");
  } else {
    selectedCategoryIds.splice(index, 1);
    cardEl.classList.remove("selected");
  }

  selectedCountEl.textContent = selectedCategoryIds.length.toString();
  startGameBtn.disabled = selectedCategoryIds.length !== 6;
}

backToTeamsBtn.addEventListener("click", () => {
  categoriesScreen.classList.add("hidden");
  teamsScreen.classList.remove("hidden");
});

// ========= بدء اللعبة وبناء اللوحة =========
startGameBtn.addEventListener("click", () => {
  if (selectedCategoryIds.length !== 6) return;

  categoriesScreen.classList.add("hidden");
  boardScreen.classList.remove("hidden");

  team1Score = 0;
  team2Score = 0;
  team1ScoreEl.textContent = "0";
  team2ScoreEl.textContent = "0";

  currentTeam = 1;
  nextStartingTeam = 1;
  setActiveTeamUI();

  // إعادة تعيين وسائل المساعدة
  lifelines[1] = { fifty: 1, call: 1 };
  lifelines[2] = { fifty: 1, call: 1 };
  updateLifelinesUI();

  buildBoard();
});

function createTile(cat, qIndex) {
  const qObj = cat.questions[qIndex];
  if (!qObj) return null;

  const tile = document.createElement("button");
  tile.className = "question-tile";
  tile.textContent = qObj.points;
  tile.dataset.categoryId = cat.id;
  tile.dataset.questionIndex = qIndex.toString();
  tile.addEventListener("click", () => handleTileClick(tile));
  return tile;
}

function buildBoard() {
  boardContainer.innerHTML = "";

  selectedCategoryIds.forEach((id) => {
    const cat = CATEGORY_MAP[id];
    if (!cat) return;

    const col = document.createElement("div");
    col.className = "board-column";
    col.dataset.categoryId = cat.id;

    const layout = document.createElement("div");
    layout.className = "column-layout";

    const leftCol = document.createElement("div");
    leftCol.className = "points-column points-left";

    const rightCol = document.createElement("div");
    rightCol.className = "points-column points-right";

    const mainCat = document.createElement("div");
    mainCat.className = "category-main";
    mainCat.innerHTML = `
      <img src="${cat.image}" alt="${cat.name}" class="column-image" />
      <div class="column-title">${cat.name}</div>
    `;

    // 3 صفوف: [0,1]  [2,3]  [4,5]
    const indexPairs = [
      [0, 1],
      [2, 3],
      [4, 5],
    ];

    indexPairs.forEach(([leftIndex, rightIndex]) => {
      const leftTile = createTile(cat, leftIndex);
      if (leftTile) leftCol.appendChild(leftTile);

      const rightTile = createTile(cat, rightIndex);
      if (rightTile) rightCol.appendChild(rightTile);
    });

    layout.appendChild(leftCol);
    layout.appendChild(mainCat);
    layout.appendChild(rightCol);

    col.appendChild(layout);
    boardContainer.appendChild(col);
  });
}

// الرجوع من اللوحة إلى اختيار الفئات
backToCategoriesBtn.addEventListener("click", () => {
  stopTimer();
  questionModal.classList.add("hidden");
  boardScreen.classList.add("hidden");
  categoriesScreen.classList.remove("hidden");
});

// ========= فتح سؤال من البلاطة =========
function handleTileClick(tile) {
  if (tile.classList.contains("used")) return;

  const catId = tile.dataset.categoryId;
  const qIndex = parseInt(tile.dataset.questionIndex, 10);
  const cat = CATEGORY_MAP[catId];
  if (!cat || !cat.questions[qIndex]) return;

  currentCategoryId = catId;
  currentQuestionIndex = qIndex;
  currentQuestion = cat.questions[qIndex];
  currentTileButton = tile;

  phase = "first";
  questionEnded = false;

  currentTeam = nextStartingTeam;
  setActiveTeamUI();
  updateLifelinesUI();

  modalCategoryLabel.textContent = cat.name;
  modalPointsLabel.textContent = `${currentQuestion.points} نقطة`;
  questionTextEl.textContent = currentQuestion.q;

  resetOptionsState();
  optionsButtons.forEach((btn, idx) => {
    const text = currentQuestion.options[idx];
    if (typeof text === "string") {
      btn.textContent = text;
      btn.dataset.index = String(idx);
      btn.style.display = "block";
      btn.disabled = false;
    } else {
      btn.style.display = "none";
    }
  });

  statusTextEl.textContent = "";
  closeQuestionBtn.disabled = false; // نخليه يقدر يقفل بعد ما يخلص

  startTimer(FIRST_CHANCE_SECONDS);
  questionModal.classList.remove("hidden");
}

// ========= عند ضغط خيار =========
optionsButtons.forEach((btn) => {
  btn.addEventListener("click", () => handleOptionClick(btn));
});

function handleOptionClick(btn) {
  if (!currentQuestion) return;

  const selectedIndex = parseInt(btn.dataset.index, 10);
  const correctIndex = currentQuestion.correct;

  optionsButtons.forEach((b) => (b.disabled = true));
  stopTimer();

  if (selectedIndex === correctIndex) {
    btn.classList.add("correct");
    statusTextEl.textContent = `إجابة صحيحة ✅ لـ ${getCurrentTeamName()}`;

    if (currentTeam === 1) {
      team1Score += currentQuestion.points;
      team1ScoreEl.textContent = team1Score.toString();
    } else {
      team2Score += currentQuestion.points;
      team2ScoreEl.textContent = team2Score.toString();
    }

    finishQuestion();
  } else {
    btn.classList.add("wrong");

    if (phase === "first") {
      statusTextEl.textContent = `إجابة خاطئة ❌ من ${getCurrentTeamName()}، فرصة للفريق الآخر`;
      giveSecondChance();
    } else {
      const correctBtn = optionsButtons.find(
        (b) => parseInt(b.dataset.index, 10) === correctIndex
      );
      if (correctBtn) correctBtn.classList.add("correct");

      statusTextEl.textContent = "إجابة خاطئة من الفريقين ❌";
      finishQuestion();
    }
  }
}

// ========= انتهاء الوقت =========
function handleTimeUp() {
  if (!currentQuestion) return;
  const correctIndex = currentQuestion.correct;

  if (phase === "first") {
    statusTextEl.textContent = `انتهى وقت ${getCurrentTeamName()} ⏰، فرصة للفريق الآخر`;
    giveSecondChance();
  } else {
    optionsButtons.forEach((btn) => {
      btn.disabled = true;
      const idx = parseInt(btn.dataset.index, 10);
      if (idx === correctIndex) btn.classList.add("correct");
    });
    statusTextEl.textContent = "انتهى الوقت على الفريقين ⏰";
    finishQuestion();
  }
}

// ========= فرصة للفريق الثاني =========
function giveSecondChance() {
  phase = "second";
  currentTeam = currentTeam === 1 ? 2 : 1;
  setActiveTeamUI();
  updateLifelinesUI();

  optionsButtons.forEach((btn) => {
    if (!btn.classList.contains("wrong")) {
      btn.disabled = false;
    }
  });

  startTimer(SECOND_CHANCE_SECONDS);
}

// ========= إنهاء السؤال =========
function finishQuestion() {
  questionEnded = true;

  if (currentTileButton) {
    currentTileButton.classList.add("used");
    currentTileButton.disabled = true;
  }

  nextStartingTeam = nextStartingTeam === 1 ? 2 : 1;
}

// زر إغلاق السؤال
closeQuestionBtn.addEventListener("click", () => {
  questionModal.classList.add("hidden");
  stopTimer();
  if (modalTimerEl) modalTimerEl.textContent = "00:00";

  phase = "idle";
  currentQuestion = null;
  currentCategoryId = null;
  currentQuestionIndex = null;
  currentTileButton = null;
});

// ========= وسائل المساعدة =========
lifelineButtons.forEach((btn) => {
  btn.addEventListener("click", () => handleLifelineClick(btn));
});

function handleLifelineClick(btn) {
  const type = btn.dataset.type;
  const team = currentTeam;

  if (lifelines[team][type] <= 0) return;

  if (!currentQuestion || phase === "idle") {
    statusTextEl.textContent = "استخدم وسيلة المساعدة داخل السؤال فقط.";
    return;
  }

  if (type === "fifty") {
    applyFiftyFifty();
  } else if (type === "call") {
    applyCallFriend();
  }

  lifelines[team][type] -= 1;
  updateLifelinesUI();
}

function applyFiftyFifty() {
  const correctIndex = currentQuestion.correct;
  const wrongButtons = optionsButtons.filter((btn) => {
    const idx = parseInt(btn.dataset.index, 10);
    return idx !== correctIndex;
  });

  if (wrongButtons.length < 2) return;

  const shuffled = [...wrongButtons].sort(() => Math.random() - 0.5);
  const toHide = shuffled.slice(0, 2);
  toHide.forEach((btn) => {
    btn.disabled = true;
    btn.style.opacity = 0.4;
  });

  statusTextEl.textContent = "تم حذف إجابتين خاطئتين 🎯";
}

function applyCallFriend() {
  if (phase !== "first") {
    statusTextEl.textContent = "اتصال بصديق فقط في فرصة الفريق الأولى.";
    return;
  }
  startTimer(CALL_FRIEND_SECONDS); // 1:30
  statusTextEl.textContent = "اتصال بصديق 🔔 لديك دقيقة ونصف للتشاور.";
}

// ========= تهيئة أولية =========
updateLifelinesUI();
console.log("SeenGame-board loaded ✅");



